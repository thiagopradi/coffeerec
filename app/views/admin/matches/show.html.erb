<div class="space-y-6">
  <div class="flex items-center gap-4">
    <%= link_to "â† Back", admin_matches_path, class: "text-slate-400 hover:text-slate-300" %>
    <h1 class="text-3xl font-bold text-white">Matches for <%= @user.name || @user.email %></h1>
  </div>

  <!-- User Profile Summary -->
  <div class="bg-slate-800 rounded-xl p-6 border border-slate-700">
    <h2 class="text-lg font-semibold text-white mb-4">Taste Profile</h2>
    <div class="flex flex-wrap gap-3">
      <span class="px-3 py-1 bg-pink-500/20 text-pink-400 rounded-full text-sm">
        ğŸ« <%= @user.taste_profile.chocolate_preference&.humanize %>
      </span>
      <span class="px-3 py-1 bg-orange-500/20 text-orange-400 rounded-full text-sm">
        ğŸŠ <%= @user.taste_profile.fruit_preference&.humanize %>
      </span>
      <span class="px-3 py-1 bg-purple-500/20 text-purple-400 rounded-full text-sm">
        ğŸ· <%= @user.taste_profile.drink_preference&.humanize %>
      </span>
      <span class="px-3 py-1 bg-blue-500/20 text-blue-400 rounded-full text-sm">
        âœ¨ <%= @user.taste_profile.texture_preference&.humanize %>
      </span>
      <span class="px-3 py-1 bg-amber-500/20 text-amber-400 rounded-full text-sm">
        â˜• <%= @user.taste_profile.brewing_method&.humanize %>
      </span>
      <span class="px-3 py-1 bg-green-500/20 text-green-400 rounded-full text-sm">
        ğŸ¯ <%= @user.taste_profile.adventure_level&.humanize %>
      </span>
    </div>
  </div>

  <!-- Recommendations -->
  <div class="space-y-4">
    <h2 class="text-xl font-semibold text-white">Top <%= @recommendations.size %> Recommendations</h2>

    <% @recommendations.each_with_index do |rec, idx| %>
      <% coffee = rec[:coffee] %>
      <% score = rec[:score] %>
      <div class="bg-slate-800 rounded-xl p-6 border border-slate-700 flex gap-6">
        <!-- Rank -->
        <div class="flex-shrink-0 w-12 h-12 rounded-full bg-gradient-to-br <%= idx == 0 ? 'from-amber-400 to-amber-600' : idx == 1 ? 'from-slate-300 to-slate-500' : idx == 2 ? 'from-amber-600 to-amber-800' : 'from-slate-600 to-slate-700' %> flex items-center justify-center text-white font-bold text-lg">
          #<%= idx + 1 %>
        </div>

        <!-- Details -->
        <div class="flex-1">
          <div class="flex items-start justify-between">
            <div>
              <h3 class="text-lg font-semibold text-white"><%= coffee.name %></h3>
              <p class="text-slate-400 text-sm mt-1"><%= coffee.description&.truncate(100) %></p>
            </div>
            <div class="text-right">
              <div class="text-2xl font-bold text-amber-400"><%= (score * 100).round(1) %>%</div>
              <div class="text-xs text-slate-500">match score</div>
            </div>
          </div>

          <!-- Flavor bars -->
          <div class="mt-4 grid grid-cols-4 gap-4">
            <% [
              { label: "Acidity", value: coffee.acidity, color: "bg-yellow-500" },
              { label: "Body", value: coffee.body, color: "bg-amber-600" },
              { label: "Sweetness", value: coffee.sweetness, color: "bg-pink-500" },
              { label: "Bitterness", value: coffee.bitterness, color: "bg-amber-800" }
            ].each do |attr| %>
              <div>
                <div class="flex justify-between text-xs mb-1">
                  <span class="text-slate-500"><%= attr[:label] %></span>
                  <span class="text-slate-400"><%= attr[:value] || 0 %></span>
                </div>
                <div class="h-1.5 bg-slate-700 rounded-full overflow-hidden">
                  <div class="h-full <%= attr[:color] %> rounded-full" style="width: <%= ((attr[:value] || 0) * 10) %>%"></div>
                </div>
              </div>
            <% end %>
          </div>

          <div class="mt-3 flex items-center gap-4 text-sm">
            <% roast_colors = { "light" => "bg-amber-300 text-amber-900", "medium" => "bg-amber-500 text-white", "dark" => "bg-amber-800 text-amber-100" } %>
            <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium <%= roast_colors[coffee.roast_level] || 'bg-slate-600' %>">
              <%= coffee.roast_level&.capitalize %> roast
            </span>
            <%= link_to "View coffee â†’", admin_coffee_path(coffee), class: "text-blue-400 hover:text-blue-300" %>
          </div>
        </div>
      </div>
    <% end %>

    <% if @recommendations.empty? %>
      <div class="bg-slate-800 rounded-xl p-12 border border-slate-700 text-center text-slate-400">
        No coffee recommendations available. Make sure coffees have flavor embeddings generated.
      </div>
    <% end %>
  </div>
</div>
